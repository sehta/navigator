<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Push Notification Example</title>
</head>
<body>
  <h1>Push Notification Example</h1>
  <button onclick="subscribeToPush()">Subscribe to Push Notifications</button>

  <script>
    async function subscribeToPush() {
      try {
        const permission = await Notification.requestPermission();
        if (permission === "granted") {
          if ('serviceWorker' in navigator) {
            const registration = await navigator.serviceWorker.register('service-worker.js');
            const subscription = await registration.pushManager.subscribe({
              userVisibleOnly: true,
              applicationServerKey: 'BEcl7qWulspsLmZkLsVombDIZZ9J3_NAcQwd8TVkTzlSlh_igELEJARCV2GcgKmM4QlCvBwpGvOiHd8WeBJLppM'
            });
            // Access subscription data
            console.log('Subscription:', subscription);
            // Extract subscription details
            const endpoint = subscription.endpoint;
            const p256dh = subscription.getKey('p256dh');
            const auth = subscription.getKey('auth');
            console.log('Endpoint:', endpoint);
            console.log('P256DH:', p256dh ? btoa(String.fromCharCode.apply(null, new Uint8Array(p256dh))) : null);
            console.log('Auth:', auth ? btoa(String.fromCharCode.apply(null, new Uint8Array(auth))) : null);
          } else {
            console.error('Service Worker is not supported in this browser');
          }
        } else {
          console.log("User Permission Denied.");
        }
      } catch (error) {
        console.error('Failed to subscribe to push notifications:', error);
      }
    }
  </script>
</body>
</html>
